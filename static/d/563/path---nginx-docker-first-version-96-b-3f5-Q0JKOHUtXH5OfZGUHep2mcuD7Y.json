{"data":{"markdownRemark":{"id":"41b11cd3-4f7d-597c-8d5c-a607366683cf","excerpt":"Introducci√≥n Todos los programadores web conocemos perfectamente el concepto de qu√© es  localhost , ya que diariamente trabajamos con el para acceder y probar‚Ä¶","html":"<h2>Introducci√≥n</h2>\n<p>Todos los programadores web conocemos perfectamente el concepto de qu√© es <em>localhost</em>, ya que diariamente trabajamos con el para acceder y probar nuestros sitios web.</p>\n<blockquote>\n<p><em>localhost</em> es el nombre del equipo local o <em>\"este equipo\"</em> el cual tiene la direcci√≥n IP <em>127.0.0.1</em>.</p>\n</blockquote>\n<p>Como todos sabemos, si ingresamos la URL <a href=\"http://localhost/\">http://localhost/</a> en el navegador estaremos accediendo al puerto 80 del equipo local y si tenemos un servidor web como <a href=\"https://httpd.apache.org/\">apache</a> o <a href=\"https://nginx.org/\">nginx</a> escuchando en ese puerto es probable que el navegador web nos muestre el sitio web que se encuentre configurado o en su defecto una p√°gina de prueba del servidor web.</p>\n<p>Y bueno, no es muy com√∫n ejecutar aplicaciones en el puerto 80 cuando estamos programando, generalmente utilizamos otro puerto como el 3000 o similares, esto nos proporciona la ventaja de ejecutar varias aplicaciones en el equipo local sin necesidad de tener un servidor remoto para la ejecuci√≥n de cada aplicaci√≥n.</p>\n<p>Un caso muy com√∫n hoy en d√≠a es el programar el frontend y el backend como proyectos separados, cada uno ejecutandose en un puerto independiente, lo que nos lleva a tener que utilizar dos URLs del tipo <a href=\"http://localhost:3000\">http://localhost:3000</a>, pero, <em>¬øno ser√≠a genial poder utilizar algo como <a href=\"http://sergio.com/\">http://sergio.com/</a> para acceder al frontend y <a href=\"http://api.sergio.com\">http://api.sergio.com</a> para la API/backend?</em> Podemos hacerlo üòé.</p>\n<h2>Instalar nginx</h2>\n<h3>Necesitamos</h3>\n<ul>\n<li>ubuntu v18.04.2 LTS</li>\n<li>docker v18.09.3</li>\n<li>docker-compose 1.23.2</li>\n<li>git 2.17.1</li>\n</ul>\n<p>Vamos a comenzar instalando <code class=\"language-text\">nginx</code> utilizando los siguientes comandos en la terminal.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> nginx</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Despu√©s de la instalaci√≥n procedemos a ingresar en el navegador web la url <a href=\"http://localhost\">http://localhost</a> donde deber√°s ver lo siguiente:</p>\n<blockquote>\n<p>TODO: agregar imagen del resultado de entrar a <a href=\"http://localhost\">http://localhost</a></p>\n</blockquote>\n<h2>Primeros pasos</h2>\n<p>Como ya lo mencionamos, <em>localhost</em> es el <strong>hostname</strong> del equipo local que direcciona ‚Äî o utiliza internamente ‚Äî la direcci√≥n IP <strong>127.0.0.1</strong>, este direccionamiento se realiza a nivel sistema operativo gracias a un archivo de configuraci√≥n de nombre <strong>hosts</strong> que dependiendo de cada sistema operativo se encuentra en <a href=\"https://en.wikipedia.org/wiki/Hosts_(file)#Location_in_the_file_system\">diferente ubicaci√≥n</a>, este archivo es del tipo texto plano, lo que significa que lo puedes vizualizar y modificar con tu editor de textos preferido.</p>\n<p>Minimamente, este archivo contiene algo similar a lo siguiente:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">127.0.0.1  localhost\n::1        localhost</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>La anterior configuraci√≥n es tan simple como decir que la direcci√≥n IP <em>127.0.0.1</em> es utilizada por el hostname <em>localhost</em>, si agregamos cualquier hostname despu√©s del hostname <em>localhost</em> estaremos mapeando esa palabra hacia la direcci√≥n IP local 127.0.0.1.</p>\n<p>Vamos, intenta agregar el hostname <em>mi-pagina-local.com</em> y luego ingresa a esa URL en el navegador.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">127.0.0.1  localhost mi-pagina-local.com\n::1        localhost</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Ver√°s que se muestra lo mismo que al entrar a <a href=\"http://localhost/\">http://localhost/</a>.</p>\n<p>Ahora bien, podemos sacar ventaja de esto para dejar de acceder a las aplicaciones web utilizando <a href=\"http://localhost:3000/\">http://localhost:3000/</a> y podemos utilizar algo como lo que mencion√© anteriormente. Vamos a agregar una nueva configuraci√≥n al archivo hosts para mapear la direcci√≥n IP local con unos nuevos hostnames:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">127.0.0.1  localhost mi-pagina-local.com\n::1        localhost\n\n<span class=\"token comment\"># Configuraci√≥n de host para aplicaciones</span>\n127.0.0.1  tiendita.com\n127.0.0.1  api.tiendita.com</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p><strong>NOTA: El archivo hosts es un archivo del sistema operativo, por lo que si quieres modificarlo deber√°s hacerlo con permisos de administrador o root.</strong></p>\n</blockquote>\n<p>Probemos acceder a <a href=\"http://tiendita.com:3000/\">http://tiendita.com:3000/</a> o <a href=\"http://api.tiendita.com:3001/\">http://api.tiendita.com:3001/</a> en el navegador web, veremos lo mismo que <a href=\"http://localhost/\">http://localhost/</a>. Los puertos no parecen nada a lo que podamos llamar URLs amigables.</p>\n<h2>Proxy Pass ‚Äî o redireccionando la URL ‚Äî</h2>\n<p>NGINX permite redireccionar una URL hacia otra...</p>\n<p><img src=\"./nginx-success.png\" alt=\"Barra de progreso de npm\"></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">cd</span> /etc/nginx</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-nginx line-numbers\"><code class=\"language-nginx\"><span class=\"token keyword\">user</span> www<span class=\"token operator\">-</span>data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">worker_processes</span> auto<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">pid</span> <span class=\"token operator\">/</span>run<span class=\"token operator\">/</span>nginx<span class=\"token punctuation\">.</span><span class=\"token keyword\">pid</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">include</span> <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>modules<span class=\"token operator\">-</span>enabled<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>conf<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">events</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">worker_connections</span> <span class=\"token number\">768</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\"># multi_accept on;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">http</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token comment\">##</span>\n\t<span class=\"token comment\"># Basic Settings</span>\n\t<span class=\"token comment\">##</span>\n\n\t<span class=\"token keyword\">sendfile</span> on<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">tcp_nopush</span> on<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">tcp_nodelay</span> on<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">keepalive_timeout</span> <span class=\"token number\">65</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">types_hash_max_size</span> <span class=\"token number\">2048</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\"># server_tokens off;</span>\n\n\t<span class=\"token comment\"># server_names_hash_bucket_size 64;</span>\n\t<span class=\"token comment\"># server_name_in_redirect off;</span>\n\n\t<span class=\"token keyword\">include</span> <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>mime<span class=\"token punctuation\">.</span><span class=\"token keyword\">types</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">default_type</span> application<span class=\"token operator\">/</span>octet<span class=\"token operator\">-</span>stream<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\">##</span>\n\t<span class=\"token comment\"># SSL Settings</span>\n\t<span class=\"token comment\">##</span>\n\n\t<span class=\"token keyword\">ssl_protocols</span> TLSv1 TLSv1<span class=\"token punctuation\">.</span><span class=\"token number\">1</span> TLSv1<span class=\"token punctuation\">.</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span> <span class=\"token comment\"># Dropping SSLv3, ref: POODLE</span>\n\t<span class=\"token keyword\">ssl_prefer_server_ciphers</span> on<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\">##</span>\n\t<span class=\"token comment\"># Logging Settings</span>\n\t<span class=\"token comment\">##</span>\n\n\t<span class=\"token keyword\">access_log</span> <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>log<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>access<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">error_log</span> <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>log<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>error<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\">##</span>\n\t<span class=\"token comment\"># Gzip Settings</span>\n\t<span class=\"token comment\">##</span>\n\n\t<span class=\"token keyword\">gzip</span> on<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\"># gzip_vary on;</span>\n\t<span class=\"token comment\"># gzip_proxied any;</span>\n\t<span class=\"token comment\"># gzip_comp_level 6;</span>\n\t<span class=\"token comment\"># gzip_buffers 16 8k;</span>\n\t<span class=\"token comment\"># gzip_http_version 1.1;</span>\n\t<span class=\"token comment\"># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span>\n\n\t<span class=\"token comment\">##</span>\n\t<span class=\"token comment\"># Virtual Host Configs</span>\n\t<span class=\"token comment\">##</span>\n\n\t<span class=\"token keyword\">include</span> <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>conf<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>conf<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">include</span> <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>sites<span class=\"token operator\">-</span>enabled<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">#mail {</span>\n<span class=\"token comment\">#\t# See sample authentication script at:</span>\n<span class=\"token comment\">#\t# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span>\n<span class=\"token comment\"># </span>\n<span class=\"token comment\">#\t# auth_http localhost/auth.php;</span>\n<span class=\"token comment\">#\t# pop3_capabilities \"TOP\" \"USER\";</span>\n<span class=\"token comment\">#\t# imap_capabilities \"IMAP4rev1\" \"UIDPLUS\";</span>\n<span class=\"token comment\"># </span>\n<span class=\"token comment\">#\tserver {</span>\n<span class=\"token comment\">#\t\tlisten     localhost:110;</span>\n<span class=\"token comment\">#\t\tprotocol   pop3;</span>\n<span class=\"token comment\">#\t\tproxy      on;</span>\n<span class=\"token comment\">#\t}</span>\n<span class=\"token comment\"># </span>\n<span class=\"token comment\">#\tserver {</span>\n<span class=\"token comment\">#\t\tlisten     localhost:143;</span>\n<span class=\"token comment\">#\t\tprotocol   imap;</span>\n<span class=\"token comment\">#\t\tproxy      on;</span>\n<span class=\"token comment\">#\t}</span>\n<span class=\"token comment\">#}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","frontmatter":{"title":"URLs amigables utilizando NGINX y docker","date":"December 04, 2018","description":null}}},"pageContext":{"slug":"/nginx-docker-first-version/","previous":{"fields":{"slug":"/hello-world/"},"frontmatter":{"title":"Hello World","date":"2015-05-01T22:12:03.284Z","description":"Hello World","path":"/hello-world/"}},"next":null}}