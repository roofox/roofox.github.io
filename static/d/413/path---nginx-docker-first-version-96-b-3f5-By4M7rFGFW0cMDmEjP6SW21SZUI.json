{"data":{"markdownRemark":{"id":"801d3fa3-f188-527c-bb4a-dea605973304","excerpt":"Introducci√≥n Todos los programadores web conocemos perfectamente el concepto de qu√© es  localhost , ya que diariamente trabajamos con el para acceder y probar‚Ä¶","html":"<h2>Introducci√≥n</h2>\n<p>Todos los programadores web conocemos perfectamente el concepto de qu√© es <em>localhost</em>, ya que diariamente trabajamos con el para acceder y probar nuestros sitios web.</p>\n<blockquote>\n<p><em>localhost</em> es el nombre del equipo local o <em>\"este equipo\"</em> el cual tiene la direcci√≥n IP <em>127.0.0.1</em>.</p>\n</blockquote>\n<p>Como todos sabemos, si ingresamos la URL <a href=\"http://localhost/\">http://localhost/</a> en el navegador estaremos accediendo al puerto 80 del equipo local y si tenemos un servidor web como <a href=\"https://httpd.apache.org/\">apache</a> o <a href=\"https://nginx.org/\">nginx</a> escuchando en ese puerto es probable que el navegador web nos muestre el sitio web que se encuentre configurado o en su defecto una p√°gina de bienvenida del servidor web.</p>\n<p>Y bueno, no es muy com√∫n ejecutar aplicaciones en el puerto 80 cuando estamos programando, generalmente utilizamos otro puerto como el 3000 o similares, esto nos proporciona la ventaja de ejecutar varias aplicaciones en el equipo local sin necesidad de tener un servidor remoto para la ejecuci√≥n de cada aplicaci√≥n.</p>\n<p>Un caso muy com√∫n hoy en d√≠a es el programar el frontend y el backend como proyectos separados, cada uno ejecutandose en un puerto independiente, lo que nos lleva a tener que utilizar dos URLs del tipo <em>localhost:&#x3C;puerto></em>, pero, <em>¬øno ser√≠a genial poder utilizar algo como <a href=\"http://contenedores.com/\">http://contenedores.com/</a> para acceder al frontend y <a href=\"http://api.contenedores.com\">http://api.contenedores.com</a> para la API/backend?</em> Podemos hacerlo üòé.</p>\n<h2>Primeros pasos</h2>\n<p>El objetivo de este ejemplo es el de realizar un redireccionamiento utilizando <a href=\"https://nginx.org/\">nginx</a> para que cuando ingresemos a <a href=\"http://my-node-app.com\">http://my-node-app.com</a> internamente el servidor web redireccione las peticiones a la direci√≥n y puerto local expuestas por <a href=\"https://www.docker.com/\">docker</a>.</p>\n<p>El flujo general ‚Äî el que al final de esta publicaci√≥n deber√≠as entender mejor ‚Äî es a como se muestra en el siguiente diagrama:</p>\n<div class=\"remark-draw remark-draw-mermaid\"><svg id=\"mermaid-1553527897329\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" height=\"100%\" style=\"max-width:850px;\" viewBox=\"-50 -10 850 551\"><style>#mermaid-1553527897329 .label{font-family:trebuchet ms,verdana,arial;color:#333}#mermaid-1553527897329 .node circle,#mermaid-1553527897329 .node ellipse,#mermaid-1553527897329 .node polygon,#mermaid-1553527897329 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1553527897329 .node.clickable{cursor:pointer}#mermaid-1553527897329 .arrowheadPath{fill:#333}#mermaid-1553527897329 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1553527897329 .edgeLabel{background-color:#e8e8e8}#mermaid-1553527897329 .cluster rect{fill:#ffffde!important;stroke:#aa3!important;stroke-width:1px!important}#mermaid-1553527897329 .cluster text{fill:#333}#mermaid-1553527897329 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:trebuchet ms,verdana,arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1553527897329 .actor{stroke:#ccf;fill:#ececff}#mermaid-1553527897329 text.actor{fill:#000;stroke:none}#mermaid-1553527897329 .actor-line{stroke:grey}#mermaid-1553527897329 .messageLine0{marker-end:\"url(#arrowhead)\"}#mermaid-1553527897329 .messageLine0,#mermaid-1553527897329 .messageLine1{stroke-width:1.5;stroke-dasharray:\"2 2\";stroke:#333}#mermaid-1553527897329 #arrowhead{fill:#333}#mermaid-1553527897329 #crosshead path{fill:#333!important;stroke:#333!important}#mermaid-1553527897329 .messageText{fill:#333;stroke:none}#mermaid-1553527897329 .labelBox{stroke:#ccf;fill:#ececff}#mermaid-1553527897329 .labelText,#mermaid-1553527897329 .loopText{fill:#000;stroke:none}#mermaid-1553527897329 .loopLine{stroke-width:2;stroke-dasharray:\"2 2\";marker-end:\"url(#arrowhead)\";stroke:#ccf}#mermaid-1553527897329 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1553527897329 .noteText{fill:#000;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:14px}#mermaid-1553527897329 .section{stroke:none;opacity:.2}#mermaid-1553527897329 .section0{fill:rgba(102,102,255,.49)}#mermaid-1553527897329 .section2{fill:#fff400}#mermaid-1553527897329 .section1,#mermaid-1553527897329 .section3{fill:#fff;opacity:.2}#mermaid-1553527897329 .sectionTitle0,#mermaid-1553527897329 .sectionTitle1,#mermaid-1553527897329 .sectionTitle2,#mermaid-1553527897329 .sectionTitle3{fill:#333}#mermaid-1553527897329 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1553527897329 .grid .tick{stroke:#d3d3d3;opacity:.3;shape-rendering:crispEdges}#mermaid-1553527897329 .grid path{stroke-width:0}#mermaid-1553527897329 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1553527897329 .task{stroke-width:2}#mermaid-1553527897329 .taskText{text-anchor:middle;font-size:11px}#mermaid-1553527897329 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1553527897329 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1553527897329 .taskText0,#mermaid-1553527897329 .taskText1,#mermaid-1553527897329 .taskText2,#mermaid-1553527897329 .taskText3{fill:#fff}#mermaid-1553527897329 .task0,#mermaid-1553527897329 .task1,#mermaid-1553527897329 .task2,#mermaid-1553527897329 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1553527897329 .taskTextOutside0,#mermaid-1553527897329 .taskTextOutside1,#mermaid-1553527897329 .taskTextOutside2,#mermaid-1553527897329 .taskTextOutside3{fill:#000}#mermaid-1553527897329 .active0,#mermaid-1553527897329 .active1,#mermaid-1553527897329 .active2,#mermaid-1553527897329 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1553527897329 .activeText0,#mermaid-1553527897329 .activeText1,#mermaid-1553527897329 .activeText2,#mermaid-1553527897329 .activeText3{fill:#000!important}#mermaid-1553527897329 .done0,#mermaid-1553527897329 .done1,#mermaid-1553527897329 .done2,#mermaid-1553527897329 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1553527897329 .doneText0,#mermaid-1553527897329 .doneText1,#mermaid-1553527897329 .doneText2,#mermaid-1553527897329 .doneText3{fill:#000!important}#mermaid-1553527897329 .crit0,#mermaid-1553527897329 .crit1,#mermaid-1553527897329 .crit2,#mermaid-1553527897329 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1553527897329 .activeCrit0,#mermaid-1553527897329 .activeCrit1,#mermaid-1553527897329 .activeCrit2,#mermaid-1553527897329 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1553527897329 .doneCrit0,#mermaid-1553527897329 .doneCrit1,#mermaid-1553527897329 .doneCrit2,#mermaid-1553527897329 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1553527897329 .activeCritText0,#mermaid-1553527897329 .activeCritText1,#mermaid-1553527897329 .activeCritText2,#mermaid-1553527897329 .activeCritText3,#mermaid-1553527897329 .doneCritText0,#mermaid-1553527897329 .doneCritText1,#mermaid-1553527897329 .doneCritText2,#mermaid-1553527897329 .doneCritText3{fill:#000!important}#mermaid-1553527897329 .titleText{text-anchor:middle;font-size:18px;fill:#000}#mermaid-1553527897329 g.classGroup text{fill:#9370db;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:10px}#mermaid-1553527897329 g.classGroup rect{fill:#ececff;stroke:#9370db}#mermaid-1553527897329 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1553527897329 .classLabel .box{stroke:none;stroke-width:0;fill:#ececff;opacity:.5}#mermaid-1553527897329 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1553527897329 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1553527897329 #compositionEnd,#mermaid-1553527897329 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1553527897329 #aggregationEnd,#mermaid-1553527897329 #aggregationStart{fill:#ececff;stroke:#9370db;stroke-width:1}#mermaid-1553527897329 #dependencyEnd,#mermaid-1553527897329 #dependencyStart,#mermaid-1553527897329 #extensionEnd,#mermaid-1553527897329 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1553527897329 .branch-label,#mermaid-1553527897329 .commit-id,#mermaid-1553527897329 .commit-msg{fill:#d3d3d3;color:#d3d3d3}</style><style>#mermaid-1553527897329 {\n    color: rgb(0, 0, 0);\n    font: normal normal 400 normal 16px / normal \"Times New Roman\";\n  }</style><g></g><g><line id=\"actor0\" x1=\"75\" y1=\"5\" x2=\"75\" y2=\"540\" class=\"actor-line\" stroke-width=\"0.5px\" stroke=\"#999\"></line><rect x=\"0\" y=\"0\" fill=\"#eaeaea\" stroke=\"#666\" width=\"150\" height=\"65\" rx=\"3\" ry=\"3\" class=\"actor\"></rect><text x=\"75\" y=\"32.5\" dominant-baseline=\"central\" alignment-baseline=\"central\" class=\"actor\" style=\"text-anchor: middle;\"><tspan x=\"75\" dy=\"0\">Usuario</tspan></text></g><g><line id=\"actor1\" x1=\"275\" y1=\"5\" x2=\"275\" y2=\"540\" class=\"actor-line\" stroke-width=\"0.5px\" stroke=\"#999\"></line><rect x=\"200\" y=\"0\" fill=\"#eaeaea\" stroke=\"#666\" width=\"150\" height=\"65\" rx=\"3\" ry=\"3\" class=\"actor\"></rect><text x=\"275\" y=\"32.5\" dominant-baseline=\"central\" alignment-baseline=\"central\" class=\"actor\" style=\"text-anchor: middle;\"><tspan x=\"275\" dy=\"0\">Navegador</tspan></text></g><g><line id=\"actor2\" x1=\"475\" y1=\"5\" x2=\"475\" y2=\"540\" class=\"actor-line\" stroke-width=\"0.5px\" stroke=\"#999\"></line><rect x=\"400\" y=\"0\" fill=\"#eaeaea\" stroke=\"#666\" width=\"150\" height=\"65\" rx=\"3\" ry=\"3\" class=\"actor\"></rect><text x=\"475\" y=\"32.5\" dominant-baseline=\"central\" alignment-baseline=\"central\" class=\"actor\" style=\"text-anchor: middle;\"><tspan x=\"475\" dy=\"0\">nginx</tspan></text></g><g><line id=\"actor3\" x1=\"675\" y1=\"5\" x2=\"675\" y2=\"540\" class=\"actor-line\" stroke-width=\"0.5px\" stroke=\"#999\"></line><rect x=\"600\" y=\"0\" fill=\"#eaeaea\" stroke=\"#666\" width=\"150\" height=\"65\" rx=\"3\" ry=\"3\" class=\"actor\"></rect><text x=\"675\" y=\"32.5\" dominant-baseline=\"central\" alignment-baseline=\"central\" class=\"actor\" style=\"text-anchor: middle;\"><tspan x=\"675\" dy=\"0\">App</tspan></text></g><defs><marker id=\"arrowhead\" refX=\"5\" refY=\"2\" markerWidth=\"6\" markerHeight=\"4\" orient=\"auto\"><path d=\"M 0,0 V 4 L6,2 Z\"></path></marker></defs><defs><marker id=\"crosshead\" markerWidth=\"15\" markerHeight=\"8\" orient=\"auto\" refX=\"16\" refY=\"4\"><path fill=\"black\" stroke=\"#000000\" stroke-width=\"1px\" d=\"M 9,2 V 6 L16,4 Z\" style=\"stroke-dasharray: 0, 0;\"></path><path fill=\"none\" stroke=\"#000000\" stroke-width=\"1px\" d=\"M 0,1 L 6,7 M 6,1 L 0,7\" style=\"stroke-dasharray: 0, 0;\"></path></marker></defs><g><text x=\"175\" y=\"93\" class=\"messageText\" style=\"text-anchor: middle;\">http://my-node-app.com</text><line x1=\"75\" y1=\"100\" x2=\"275\" y2=\"100\" class=\"messageLine0\" stroke-width=\"2\" stroke=\"black\" marker-end=\"url(#arrowhead)\" style=\"fill: none;\"></line></g><g><rect x=\"200\" y=\"110\" fill=\"#EDF2AE\" stroke=\"#666\" width=\"150\" height=\"84\" rx=\"0\" ry=\"0\" class=\"note\"></rect><text x=\"196\" y=\"134\" fill=\"black\" class=\"noteText\"><tspan x=\"216\" fill=\"black\">Se resuelve la ip de</tspan></text><text x=\"196\" y=\"150\" fill=\"black\" class=\"noteText\"><tspan x=\"216\" fill=\"black\">my-node-app.com</tspan></text><text x=\"196\" y=\"166\" fill=\"black\" class=\"noteText\"><tspan x=\"216\" fill=\"black\">desde el archivo</tspan></text><text x=\"196\" y=\"182\" fill=\"black\" class=\"noteText\"><tspan x=\"216\" fill=\"black\">hosts</tspan></text></g><g><text x=\"375\" y=\"222\" class=\"messageText\" style=\"text-anchor: middle;\">127.0.0.1:80</text><line x1=\"275\" y1=\"229\" x2=\"475\" y2=\"229\" class=\"messageLine0\" stroke-width=\"2\" stroke=\"black\" marker-end=\"url(#arrowhead)\" style=\"fill: none;\"></line></g><g><rect x=\"250\" y=\"239\" fill=\"#EDF2AE\" stroke=\"#666\" width=\"250\" height=\"52\" rx=\"0\" ry=\"0\" class=\"note\"></rect><text x=\"246\" y=\"263\" fill=\"black\" class=\"noteText\"><tspan x=\"266\" fill=\"black\">Se env√≠a el header</tspan></text><text x=\"246\" y=\"279\" fill=\"black\" class=\"noteText\"><tspan x=\"266\" fill=\"black\">Host: my-node-app.com</tspan></text></g><g><rect x=\"400\" y=\"301\" fill=\"#EDF2AE\" stroke=\"#666\" width=\"150\" height=\"84\" rx=\"0\" ry=\"0\" class=\"note\"></rect><text x=\"396\" y=\"325\" fill=\"black\" class=\"noteText\"><tspan x=\"416\" fill=\"black\">Mediante el header</tspan></text><text x=\"396\" y=\"341\" fill=\"black\" class=\"noteText\"><tspan x=\"416\" fill=\"black\">Host determina el</tspan></text><text x=\"396\" y=\"357\" fill=\"black\" class=\"noteText\"><tspan x=\"416\" fill=\"black\">host y puerto a</tspan></text><text x=\"396\" y=\"373\" fill=\"black\" class=\"noteText\"><tspan x=\"416\" fill=\"black\">redireccionar</tspan></text></g><g><text x=\"575\" y=\"413\" class=\"messageText\" style=\"text-anchor: middle;\">http://localhost:3618</text><line x1=\"475\" y1=\"420\" x2=\"675\" y2=\"420\" class=\"messageLine0\" stroke-width=\"2\" stroke=\"black\" marker-end=\"url(#arrowhead)\" style=\"fill: none;\"></line></g><g><text x=\"475\" y=\"448\" class=\"messageText\" style=\"text-anchor: middle;\">Env√≠a la respuesta HTTP al navegador</text><line x1=\"675\" y1=\"455\" x2=\"275\" y2=\"455\" class=\"messageLine1\" stroke-width=\"2\" stroke=\"black\" marker-end=\"url(#arrowhead)\" style=\"stroke-dasharray: 3, 3; fill: none;\"></line></g><g><rect x=\"0\" y=\"475\" fill=\"#eaeaea\" stroke=\"#666\" width=\"150\" height=\"65\" rx=\"3\" ry=\"3\" class=\"actor\"></rect><text x=\"75\" y=\"507.5\" dominant-baseline=\"central\" alignment-baseline=\"central\" class=\"actor\" style=\"text-anchor: middle;\"><tspan x=\"75\" dy=\"0\">Usuario</tspan></text></g><g><rect x=\"200\" y=\"475\" fill=\"#eaeaea\" stroke=\"#666\" width=\"150\" height=\"65\" rx=\"3\" ry=\"3\" class=\"actor\"></rect><text x=\"275\" y=\"507.5\" dominant-baseline=\"central\" alignment-baseline=\"central\" class=\"actor\" style=\"text-anchor: middle;\"><tspan x=\"275\" dy=\"0\">Navegador</tspan></text></g><g><rect x=\"400\" y=\"475\" fill=\"#eaeaea\" stroke=\"#666\" width=\"150\" height=\"65\" rx=\"3\" ry=\"3\" class=\"actor\"></rect><text x=\"475\" y=\"507.5\" dominant-baseline=\"central\" alignment-baseline=\"central\" class=\"actor\" style=\"text-anchor: middle;\"><tspan x=\"475\" dy=\"0\">nginx</tspan></text></g><g><rect x=\"600\" y=\"475\" fill=\"#eaeaea\" stroke=\"#666\" width=\"150\" height=\"65\" rx=\"3\" ry=\"3\" class=\"actor\"></rect><text x=\"675\" y=\"507.5\" dominant-baseline=\"central\" alignment-baseline=\"central\" class=\"actor\" style=\"text-anchor: middle;\"><tspan x=\"675\" dy=\"0\">App</tspan></text></g></svg></div>\n<h1>Sofware necesario</h1>\n<p>Utilizaremos un ambiente linux para la demostraci√≥n del ejemplo y necesitaremos lo siguiente:</p>\n<ul>\n<li><a href=\"https://www.ubuntu.com/\">ubuntu</a> <code class=\"language-text\">v18.04.2 LTS</code></li>\n<li><a href=\"https://www.docker.com/\">docker</a> <code class=\"language-text\">v18.09.3</code></li>\n<li><a href=\"https://docs.docker.com/compose/\">docker-compose</a> <code class=\"language-text\">v1.23.2</code></li>\n<li><a href=\"https://www.git-scm.com/\">git</a> <code class=\"language-text\">v2.17.1</code></li>\n</ul>\n<blockquote>\n<p>Este ejemplo puede ejecutarse f√°cilmente en otros sistemas operativos como <code class=\"language-text\">Windows</code> o <code class=\"language-text\">macOS</code> siguiendo la mayor√≠a de las instrucciones.</p>\n</blockquote>\n<h2>Ejecutar las aplicaciones de ejemplo</h2>\n<p>Vamos a crear un archivo <a href=\"https://github.com/roofox/cc9a-nginx-docker/blob/master/docker-compose.yml\"><code class=\"language-text\">docker-compose.yml</code></a> en la ruta que prefieras al cual agregar√°s el siguiente contenido:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.5\"</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">node</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> cc9a<span class=\"token punctuation\">-</span>nginx<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>node\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> roofox/cc9a<span class=\"token punctuation\">-</span>nginx<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>node<span class=\"token punctuation\">:</span><span class=\"token number\">0.1</span>\n        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token string\">\"3618:80\"</span>\n        <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span> \n            <span class=\"token punctuation\">-</span> nginx<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>network\n    <span class=\"token key atrule\">python</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> cc9a<span class=\"token punctuation\">-</span>nginx<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>python\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> roofox/cc9a<span class=\"token punctuation\">-</span>nginx<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>python<span class=\"token punctuation\">:</span><span class=\"token number\">0.1</span>\n        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token string\">\"3620:80\"</span>\n    <span class=\"token key atrule\">php</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> cc9a<span class=\"token punctuation\">-</span>nginx<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>php\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> roofox/cc9a<span class=\"token punctuation\">-</span>nginx<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>php<span class=\"token punctuation\">:</span><span class=\"token number\">0.1</span>\n        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token string\">\"3622:80\"</span>\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">nginx-docker-network</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cc9a<span class=\"token punctuation\">-</span>nginx<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>network\n        <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> bridge</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Como puedes ver, estamos creando tres servicios en los cuales vamos a exponer en un puerto diferente un servidor web utilizando lenguajes de programaci√≥n diferentes, en cada servicio se mostrar√° un texto de ejemplo generado desde cada uno de ellos.</p>\n<p>Vamos a posicionarnos desde la l√≠nea de comandos en el directorio donde creamos el archivo <code class=\"language-text\">docker-compose.yml</code> y ejecutaremos el comando <code class=\"language-text\">docker-compose up</code>.</p>\n<p><a href=\"docker\">Docker</a> comenzar√° a descargar las imagenes de los servicios (tardar√° unos cuantos minutos) para finalmente mostrarlos en ejecuci√≥n.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/de6ebc7a60f3ce43bf0752349ffa0425/5cbb4/docker-compose-up.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 67.59002770083103%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACXUlEQVQoz12SaW+bQBCG+dIzSZumiY/YMQbMjc1llhsW2MUHNrhVq7Rq+v//RgdHqpRIr17N7jI7zwzLdN2ma+u2pW1Xg44tPZ223Wnz6/e3P08/QE9/f56+75ojORzpoXcC3xy7+vGxZaooKfK6yWiTVi3eHlJSo6ywwlh3PXHlyxZ6dskED1U7UPodEJwyVEqJVmzkbKdkhI/2Kt4pOZ6hkgtAVIgL1q+4oOJD/8aIBmY0WOlv5sZbDsQ0RnkwCirFzbKgYrI38E7Hey1P7h1voCBWXH9Rnc+ye60uP/DGu7nxntPPDmJ2enlYEajfGMXBpHu9hOsaA8djBw3V9Yx3rxWQc/b1tQqObg3vRgOHyimemcGdGg2VeGzEIy0eW/G9nUxcKB6NrHTq5qwHDpvgQIFul5Dp3xlMNOOSOZ+wQr4QYnYRPwgbOTmahIpxZ9dkEUELGxgHBEaxVTM8RyUfQIF04jJ4gTbLtJQQ0cKtmVM1AuzOoq1VV0IUjcx85vUsYztnEeBUQlhLSTpdY9ZnUs6ieoAFp1K9Wg8r2d9Dsk0bvajlNJ3YFR8ALdSB4UM+gWQZkl1AYLDoYMklqoclp9IQFte1mAAekBfnv5VNHeAEClhmD2sAIWL8DM8QNSpFL+dcb6igkRqMjXBoAi2AAWQ2dWEJOXjuF5wfDFbJvV3M/WTi9D0TzS8kJ5hoqWDG7BKuKLlzVxMHZrbTMDQJ+eiun7D3VfP7OZ/jG52xr2TrUrQuJQeCK8m8EK2rXqsLwbxc2J8kOP3/Kl6JebXun9HL4DlefuR7f6l/0Oae6NbF1MUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Ejecutando docker-compose up\"\n        title=\"\"\n        src=\"/static/de6ebc7a60f3ce43bf0752349ffa0425/623ee/docker-compose-up.png\"\n        srcset=\"/static/de6ebc7a60f3ce43bf0752349ffa0425/816c5/docker-compose-up.png 148w,\n/static/de6ebc7a60f3ce43bf0752349ffa0425/c766b/docker-compose-up.png 295w,\n/static/de6ebc7a60f3ce43bf0752349ffa0425/623ee/docker-compose-up.png 590w,\n/static/de6ebc7a60f3ce43bf0752349ffa0425/5cbb4/docker-compose-up.png 722w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>Si ingresamos en un navegador web con cada uno de los puertos (<code class=\"language-text\">3618</code>, <code class=\"language-text\">3620</code> y <code class=\"language-text\">3622</code>) veremos el mensaje que despliega cada uno de los servicios as√≠ como el saber que se encuentra en ejecuci√≥n.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/11f81d10604eca8efb0071f954a98ad3/2232e/browser-localhost.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 68.52367688022285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAAA2ElEQVQoz+2LbQvBUBzF7webF2zzkCzGElEey1NsfBsv+GAe08x2t3vZ7DYUM1aSvFBe8ut0Ov3P/4BKni/lUuU8Xy1kakWhXhR4LsLQVDwWygqckE4kuQhLU2EmcBN7F01Fo8FMggGr5XwxnSxmU3UtY12zdng8GnZa9b7UHkgdz/3gS+w1xW5TEluei90GsEzTtveGoSNDPzgOIUSHECFEiH06HV/kfWKM7L1l7rZbjADUVEXZKMoaQqhqmizLGGPXdS/veNz9AJ678x2/+wTgfsF//BvjKxu8/UKo50MXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"App en ejecuci√≥n\"\n        title=\"\"\n        src=\"/static/11f81d10604eca8efb0071f954a98ad3/623ee/browser-localhost.png\"\n        srcset=\"/static/11f81d10604eca8efb0071f954a98ad3/816c5/browser-localhost.png 148w,\n/static/11f81d10604eca8efb0071f954a98ad3/c766b/browser-localhost.png 295w,\n/static/11f81d10604eca8efb0071f954a98ad3/623ee/browser-localhost.png 590w,\n/static/11f81d10604eca8efb0071f954a98ad3/2232e/browser-localhost.png 718w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>Y bueno, tres servicios ejecutandose en diferentes puertos del equipo local, es hora de comenzar con los pasos para el redireccionamiento.</p>\n<h2>Instalar nginx</h2>\n<p>Vamos a comenzar instalando <a href=\"https://nginx.org/\">nginx</a> utilizando los siguientes comandos en la terminal.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> nginx</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Despu√©s de la instalaci√≥n procedemos a ingresar en el navegador web la url <a href=\"http://localhost\">http://localhost</a> donde deber√°s ver lo siguiente:</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/98d0cc1fd7bb4ee1e97e56b8ca6b42bb/2232e/welcome-to-nginx.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 68.52367688022285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABp0lEQVQoz9VQ227TQBD1fxUqooRckCoB4oGXVJFQ1IKbiwMhRfSfKlXiB/KEhFKkykFO3SayHXttr3fXdpw0iW+sNwECKk88cTQazWrnnJk5XKX06EmZRq5U3C8WHhbye9WXzzr8q0a92jqqtY5r3Uadrx8+f1qhv8XHLPIPyuXci4MC13svnH3sfjjtvO2cCALf4OufLs6NqaYpE3VyCy0w973Bl8+9d61Omxdab9rN10I7y+3mMUcIcl1CMPI9N1yvlncL4pLFcpkyJEkcRmEUhavVcr1eBcEMYxTMaG9G4TZNqqLI8o1h6LqRJcdxFEXRDd31vIQKxHHCwOR+FVzCyNcjaXD5dSiKw+FwNJI0Tev3+6IoIoQ2fel92ExOCCG2bRkAqJpm27aqqjQHs8DzfQc5pgkgBKap08IEQNf1dRj+JKcAGJPJmOJalscMiqJigqkodcRzfQgjhCO2Pj0i3p2ckTc0SRrJDJL0TZLsqys81TD1CToxJukf62/JdIJlWshxIISWZQbzOTs1/cuxv5N3Xcm83T6TH+4m9wpx6T/gPyV/B+8x7F7R6jZbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"P√°gina de bienvenida de nginx\"\n        title=\"\"\n        src=\"/static/98d0cc1fd7bb4ee1e97e56b8ca6b42bb/623ee/welcome-to-nginx.png\"\n        srcset=\"/static/98d0cc1fd7bb4ee1e97e56b8ca6b42bb/816c5/welcome-to-nginx.png 148w,\n/static/98d0cc1fd7bb4ee1e97e56b8ca6b42bb/c766b/welcome-to-nginx.png 295w,\n/static/98d0cc1fd7bb4ee1e97e56b8ca6b42bb/623ee/welcome-to-nginx.png 590w,\n/static/98d0cc1fd7bb4ee1e97e56b8ca6b42bb/2232e/welcome-to-nginx.png 718w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>Esta es la p√°gina de bienvenida de <a href=\"https://nginx.org/\">nginx</a>, lo que nos indica que el servidor web est√° en ejecuci√≥n y se encuentra en escucha utilizando el puerto <code class=\"language-text\">80</code>.</p>\n<h2>Deshaci√©ndonos de localhost</h2>\n<p>Como ya lo mencionamos, <em>localhost</em> es el <strong>hostname</strong> del equipo local que est√° asignado a la direcci√≥n IP <strong>127.0.0.1</strong>, esta asignaci√≥n se realiza a nivel sistema operativo gracias a un archivo de configuraci√≥n de nombre <strong>hosts</strong> que dependiendo de cada sistema operativo se encuentra en <a href=\"https://en.wikipedia.org/wiki/Hosts_(file)#Location_in_the_file_system\">diferente ubicaci√≥n</a>, este archivo es del tipo texto plano, lo que significa que lo puedes vizualizar y modificar con tu editor de textos preferido.</p>\n<p>Minimamente, este archivo contiene algo similar a lo siguiente:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">127.0.0.1  localhost\n::1        localhost</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>La configuraci√≥n anterior es tan simple como decir que el hostname <em>localhost</em> est√° asingado a la direcci√≥n IP <em>127.0.0.1</em>, si agregamos cualquier hostname despu√©s de  <em>localhost</em> estaremos asignando ese host a la direcci√≥n IP 127.0.0.1.</p>\n<blockquote>\n<p><strong>NOTA: El archivo hosts es un archivo del sistema operativo, por lo que si quieres modificarlo deber√°s hacerlo con permisos de administrador o root.</strong></p>\n</blockquote>\n<p>Vamos, edita el archivo <code class=\"language-text\">/etc/hosts</code> y agrega el hostname <em>mi-pagina-local.com</em> y luego ingresa a esa URL en el navegador.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">127.0.0.1  localhost mi-pagina-local.com\n::1        localhost</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Ver√°s que se muestra lo mismo que al entrar a <a href=\"http://localhost/\">http://localhost/</a>.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/64644324b83e08fab3dcb4d3eb74b589/2232e/mi-pagina-local.com.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 68.52367688022285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABpElEQVQoz9WQy06DQBSGeSgvsTdrq9GFNSbqxmcwJrZFbW3Vt3Bh4t7ExHfoXk0MNVRqFZAOMDAzUKBXiwMYU42uXPnNyZnrf86ZwyTjs8lEYPHYdGxuKhGfSadiS5lUJp1YSCeoz2aSi5nkfGoum45vra1srq1s5Ja3N3Lrq8vM4cFe9Wi/XCqw+R22sFsps5VSkVr5MM8Wd48rB9Uj9vSkVMzvXJyfKbIotpovT4IJ9eurSwYjRDDGyLQtMuj3e14XmaZpGAQT13NHo2Gv16XH1AaDfrfrWRbxPLdj2wQjxg+RRFEQmqAdQD2VS5IMALDtDr0dByPgbQK6Zcah+LHB39ze1TmuXq83Grwsy7VajeM4GiUQj6NX34kyj2nhuq61AZBkWdd1SZKodzqOZduGaagqgBCoqkIXKgCKogyGw0+xD0D7+blFeRSEVogoSggjGpQQbBEbwpGJRmGxQc2TmQNxJOP5hhDC8w88r9/fo1cZOU4HGm8I+9/K/xDTDJqq0SZDCDVNdVw3/Kr/y2e/iie7EnTyYxvNET8EYvw/8E/F73+651hfYyJRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Lo mismo que localhost\"\n        title=\"\"\n        src=\"/static/64644324b83e08fab3dcb4d3eb74b589/623ee/mi-pagina-local.com.png\"\n        srcset=\"/static/64644324b83e08fab3dcb4d3eb74b589/816c5/mi-pagina-local.com.png 148w,\n/static/64644324b83e08fab3dcb4d3eb74b589/c766b/mi-pagina-local.com.png 295w,\n/static/64644324b83e08fab3dcb4d3eb74b589/623ee/mi-pagina-local.com.png 590w,\n/static/64644324b83e08fab3dcb4d3eb74b589/2232e/mi-pagina-local.com.png 718w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>Y si agregas uno de los puertos de los servicios, tambi√©n ver√°s lo mismo.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c9fe1bcf97e9df47688dd2517f0aa036/2232e/mi-pagina-local.com-3618.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 68.52367688022285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAAA5ElEQVQoz2NIjA5OjAxMjAxKjAqKjwhIiQkJ8nN3cbb29nKKCPMPC/YN8HN3dbZxc7EFIVcwcrbx8HAM8XVhePTg3r07t+7fvf3o/t17d26/ff1q4fw52VkphflZBfmZQLKoMLu4MAeCgCIFeZmFBVlAsiAvg+HTxw+fP3968+b12zdvfv748e3b11evX7188fLN69fv3r378vXLr18/4ejLl8/v3r398hmo6f37d28ZXr16+ezZ82fPnr189erFy5dPnjwB6vn///8/bAAuDmEwIMv9BQOIHDGA4T8FYFTzyNAMAM1C/Hlq26LZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Lo mismo que el localhost:3618\"\n        title=\"\"\n        src=\"/static/c9fe1bcf97e9df47688dd2517f0aa036/623ee/mi-pagina-local.com-3618.png\"\n        srcset=\"/static/c9fe1bcf97e9df47688dd2517f0aa036/816c5/mi-pagina-local.com-3618.png 148w,\n/static/c9fe1bcf97e9df47688dd2517f0aa036/c766b/mi-pagina-local.com-3618.png 295w,\n/static/c9fe1bcf97e9df47688dd2517f0aa036/623ee/mi-pagina-local.com-3618.png 590w,\n/static/c9fe1bcf97e9df47688dd2517f0aa036/2232e/mi-pagina-local.com-3618.png 718w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>Ahora bien, podemos sacar ventaja de esto para dejar de acceder a las aplicaciones web utilizando el hostname <strong>localhost</strong> y podemos utilizar algo como lo que mencion√© anteriormente. Vamos a agregar una nueva configuraci√≥n al archivo hosts para mapear la direcci√≥n IP local con unos nuevos hostnames:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">127.0.0.1  localhost mi-pagina-local.com\n::1        localhost\n\n<span class=\"token comment\"># Configuraci√≥n de host para aplicaciones</span>\n127.0.0.1  my-node-app.com\n127.0.0.1  my-python-app.com\n127.0.0.1  my-php-app.com</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Probemos acceder a cualquiera de los hostnames que definimos en el archivo anterior con el navegador web, veremos que de igual manera aparece lo mismo que al ingresar a <a href=\"http://localhost/\">http://localhost/</a> y si agregamos los puertos de los servicios tambi√©n funcionar√°.</p>\n<h2>Proxy Pass ‚Äî o redireccionando el tr√°fico ‚Äî</h2>\n<p><a href=\"nginx\">nginx</a> permite redireccionar el tr√°fico de una URL hacia otra utilizando la directiva <a href=\"proxy-pass\">proxy-pass</a> del m√≥dulo <code class=\"language-text\">ngx_http_proxy_module</code>, es muy com√∫n utilizar est√° directiva para colocar varios servidores en un mismo espacio de URL.</p>\n<p>Dentro del directorio <code class=\"language-text\">/etc/nginx/</code> se encuentra el archivo de configuraci√≥n <code class=\"language-text\">nginx.conf</code>, si lo editamos veremos que en alguna parte de la secci√≥n <code class=\"language-text\">http</code> contiene lo siguiente:</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-conf line-numbers\"><code class=\"language-conf\">include /etc/nginx/conf.d/*.conf;\ninclude /etc/nginx/sites-enabled/*;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Con esas l√≠neas se est√°n incluyendo todas las configuraciones que se encuentren dentro de esos directorios en la secci√≥n <code class=\"language-text\">http</code> del archivo principal, y si listamos el contenido del directorio <code class=\"language-text\">sites-enabled</code> veremos que el √∫nico archivo de nombre <code class=\"language-text\">default</code> es un elance simb√≥lico haciendo referencia al archivo tambi√©n de nombre <code class=\"language-text\">default</code> dentro del directorio <code class=\"language-text\">sites-available</code>.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/267d9c025ab10eb8dbde5f6d1aea0aab/5cbb4/sites-enabled.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 67.59002770083103%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABQElEQVQoz+2LbU+CUBiGz1b5tpYY6PBDE0gEPecAih6MN5fKIZ2CNcstzbX6//8hML/krA9+brv27N793BeI43ARBXFMo0UYxWEU0fjxYbN9/vhcb96W683ydf20fV8tX2az+XgeBXtiulpFYOR698PJmPhTZzh1x3M/GJmOr5E7td2RYLeOSUPbI/+gJ2sgUDxfdp1q267odsVweMNisXmldovNXqnVLtTh2Q26EGDCee0AMEOjQOrbvE4bDlW8odgPZCdUPNpwqeLaNYKrhl5STUYlHLI4lNweCwkHrTIGFA8Gqp+kfhmbTLNTVIxLucs0zaKaZhZiXteYVLbKKJmRxGTRXjY4BfKGed1K1jBTQzkxJSugnPAdcEbAuxJmhQMAyoo4cdK1iPPSEQrS8T4vgd379rf334DTtH/5JL4AdGt5kzulBt4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Sitios habilitados\"\n        title=\"Sitios habilitados\"\n        src=\"/static/267d9c025ab10eb8dbde5f6d1aea0aab/623ee/sites-enabled.png\"\n        srcset=\"/static/267d9c025ab10eb8dbde5f6d1aea0aab/816c5/sites-enabled.png 148w,\n/static/267d9c025ab10eb8dbde5f6d1aea0aab/c766b/sites-enabled.png 295w,\n/static/267d9c025ab10eb8dbde5f6d1aea0aab/623ee/sites-enabled.png 590w,\n/static/267d9c025ab10eb8dbde5f6d1aea0aab/5cbb4/sites-enabled.png 722w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>Vamos a crear un archivo donde definiremos la configuraci√≥n para uno de los servicios creados con <a href=\"docker\">docker</a>, comenzaremos con el servicio de node.js, para ello hay que crear el archivo <code class=\"language-text\">/etc/nginx/sites-available/my-node-app.com</code> al cual agregaremos la siguiente configuraci√≥n:</p>\n<blockquote>\n<p><strong>NOTA: El directorio <code class=\"language-text\">/etc/nginx</code> es un directorio en el que solamente se pueden crear √≥ modificar archivos con permisos de usuario root.</strong></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-conf line-numbers\"><code class=\"language-conf\">server {\n\tlisten 80;\n    listen [::]:80;\n\n    server_name my-node-app.com;\n\n    location ^~ / {\n        proxy_pass http://localhost:3618;\n    }\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ahora, crearemos un enlace simb√≥lico de nombre <code class=\"language-text\">my-node-app.com</code> dentro del directorio <code class=\"language-text\">sites-enabled</code> que har√° referenc√≠a al archivo posteriormente creado en el directorio <code class=\"language-text\">sites-available</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">ln</span> -s /etc/nginx/sites-available/my-node-app.com /etc/nginx/sites-enabled/my-node-app.com</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Con esto tenemos la configuraci√≥n terminada y procederemos a reiniciar el servicio de <a href=\"nginx\">nginx</a> con el siguiente comando:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> nginx -s reload</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Listo, ¬°ingresa en el navegador web a <a href=\"http://my-node-app.com\">http://my-node-app.com</a> y ver√°s lo mismo que el servicio ejecutandose en <a href=\"http://localhost:3618\">http://localhost:3618</a>!</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/82b674e7c4ebdafa16da4e39a58d2f98/2232e/my-node-app.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 68.52367688022285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAAA8klEQVQoz2Pwcnfw8nD09HDwdHdwc7F1c7X1cLP3dLf383WNjAgMDfb193Xz8XJKiAwEosSooKTo4JTY0NSEiNgQb4aK8qLqqpKqiqLK8qKCvMyiwuyy0vyaqhIgAooAuXm56RP7ux4/uPfw/r37d+88efTg3ZvXL58/7e/tZHj37u2H9+9evnj+6uWLb1+/fPr06fVrIPPlq1evvn77+vv3r58/f/769fPv3z9A9O37tw8fPwCVff708f27twxApc9fAPU+f/36DVDDs2dP371//////39///5DAn8xAFANA6YKIOM/cYDhPwVgVPPI0AwAS//+JNglvDEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"¬°my-node-app.com sin puerto!\"\n        title=\"¬°my-node-app.com sin puerto!\"\n        src=\"/static/82b674e7c4ebdafa16da4e39a58d2f98/623ee/my-node-app.png\"\n        srcset=\"/static/82b674e7c4ebdafa16da4e39a58d2f98/816c5/my-node-app.png 148w,\n/static/82b674e7c4ebdafa16da4e39a58d2f98/c766b/my-node-app.png 295w,\n/static/82b674e7c4ebdafa16da4e39a58d2f98/623ee/my-node-app.png 590w,\n/static/82b674e7c4ebdafa16da4e39a58d2f98/2232e/my-node-app.png 718w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h1>Funcionamiento de <code class=\"language-text\">proxy_pass</code> y <code class=\"language-text\">server_name</code></h1>\n<p>La m√°gia que acabas de hacer, es posible gracias a las directivas <a href=\"proxy-pass\">proxy-pass</a> y <a href=\"server-name\">server-name</a> las cuales hacen que la configuraci√≥n sea tan sencilla como hacer un <strong>match</strong> o <strong>if</strong>.</p>\n<ul>\n<li>El tag <code class=\"language-text\">server</code> define una nueva configuraci√≥n de servidor</li>\n<li>Con el tag <code class=\"language-text\">listen 80</code> definimos que nginx escuche por el puerto 80.</li>\n<li><code class=\"language-text\">server_name my-node-app.com</code> define el nombre del servidor, valor que se utilizar√° para compararlo con el header <code class=\"language-text\">host</code> que se env√≠e en la petici√≥n HTTP y mismo que defin√≠mos en el archivo <code class=\"language-text\">hosts</code> del sistema operativo.</li>\n<li>Con los tags <code class=\"language-text\">location ^~ /</code> y <code class=\"language-text\">proxy_pass http://localhost:3618;</code> definimos que cuando se acceda a la URL ra√≠z √≥ <code class=\"language-text\">/</code> se realice el redireccionamiento de la petici√≥n HTTP al <code class=\"language-text\">host</code>:<code class=\"language-text\">puerto</code> especificados, en este caso <code class=\"language-text\">localhost</code>:<code class=\"language-text\">3618</code>.</li>\n</ul>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"conf\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-conf line-numbers\"><code class=\"language-conf\">server {\n\tlisten 80;\n    listen [::]:80;\n\n    server_name my-node-app.com;\n\n    location ^~ / {\n        proxy_pass http://localhost:3618;\n    }\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1>Terminando</h1>\n<p>Para finalizar, realiza exactamente los mismos pasos para los dos servicios restantes, creando dos nuevos archivos de configuraci√≥n y cambiando los valores de las directivas <code class=\"language-text\">proxy_pass</code> y <code class=\"language-text\">server_name</code>.</p>\n<blockquote>\n<p>TODO:</p>\n<ul>\n<li>Cambiar <a href=\"proxypass\">proxy-pass</a> por <code class=\"language-text\">proxy_pass</code> y <code class=\"language-text\">server-name</code> por <code class=\"language-text\">server_name</code>.</li>\n<li>Arreglar los enlances de <code class=\"language-text\">proxy_pass</code> y <code class=\"language-text\">server_name</code>.</li>\n<li>-</li>\n</ul>\n</blockquote>","frontmatter":{"title":"URLs amigables utilizando NGINX y docker","date":"December 04, 2018","description":"Hello World"}}},"pageContext":{"slug":"/nginx-docker-first-version/","previous":{"fields":{"slug":"/hello-world/"},"frontmatter":{"title":"Hello World","date":"2015-05-01T22:12:03.284Z","description":"Hello World","path":"/hello-world/","cover":"7cfc"}},"next":null,"cover":"cc9a"}}